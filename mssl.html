<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PP2 Off Loading Sheet</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
        .section-title {
            text-align: center;
            font-size: 1.5em;
            margin: 20px 0;
        }
        .add-row-btn, .compile-btn {
            margin: 10px 5px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .add-row-btn:hover, .compile-btn:hover {
            background-color: #0056b3;
        }
        .number-input {
            width: 60px;
            text-align: center;
        }
        .calc-btn {
            margin: 2px;
            padding: 5px 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        .calc-btn:hover {
            background-color: #218838;
        }
        .reset-btn {
            background-color: #dc3545;
        }
        .reset-btn:hover {
            background-color: #c82333;
        }
    </style>
</head>
<body>
    <div class="section-title">PP2 Off Loading Sheet</div>
    <table id="loadingSheet">
        <thead>
            <tr>
                <th>Part</th>
                <th>Color</th>
                <th>Total</th>
                <th>Rework</th>
                <th>Polished</th>
                <th>Scrap</th>
                <th>Remarks</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <select>
                        <option value="H Bar_WLT">H Bar_WLT</option>
                        <option value="H_Bar LTD">H_Bar LTD</option>
                        <option value="WLT">WLT</option>
                        <option value="XLT">XLT</option>
                        <option value="LTD">LTD</option>
                        <option value="MID">MID</option>
                        <option value="High Bumper">High Bumper</option>
                        <option value="BOX Rails J73">BOX Rails J73</option>
                        <option value="Box Rails P703">Box Rails P703</option>
                        <option value="Lower P703">Lower P703</option>
                        <option value="Lower J703">Lower J703</option>
                        <option value="Sporthoop J703">Sporthoop J703</option>
                        <option value="Inner P703">Inner P703</option>
                        <option value="Inner J703">Inner J703</option>
                    </select>
                </td>
                <td>
                    <select>
                        <option value="Boulder Gray">Boulder Gray</option>
                        <option value="Black">Black</option>
                        <option value="Moroccan Blue">Moroccan Blue</option>
                        <option value="Frozen White">Frozen White</option>
                        <option value="D. Silver">D. Silver</option>
                        <option value="I. Silver">I. Silver</option>
                    </select>
                </td>
                <td class="total-cell">0</td>
                <td class="rework-cell">
                    <input type="number" class="number-input" value="0" />
                    <input type="number" class="number-input" value="0" />
                    <button class="calc-btn" onclick="calculate(this, 'rework')">Add</button>
                    <button class="calc-btn reset-btn" onclick="reset(this)">Reset</button>
                    <select class="rework-defect">
                        <option value="None">None</option>
                        <option value="Deep Cut">Deep Cut</option>
                        <option value="Scratch">Scratch</option>
                        <option value="3×Painted">3×Painted</option>
                    </select>
                </td>
                <td class="polished-cell">
                    <input type="number" class="number-input" value="0" />
                    <input type="number" class="number-input" value="0" />
                    <button class="calc-btn" onclick="calculate(this, 'polished')">Add</button>
                    <button class="calc-btn reset-btn" onclick="reset(this)">Reset</button>
                </td>
                <td class="scrap-cell">
                    <input type="number" class="number-input" value="0" />
                    <input type="number" class="number-input" value="0" />
                    <button class="calc-btn" onclick="calculate(this, 'scrap')">Add</button>
                    <button class="calc-btn reset-btn" onclick="reset(this)">Reset</button>
                    <select class="scrap-defect">
                        <option value="None">None</option>
                        <option value="Deep Cut">Deep Cut</option>
                        <option value="Scratch">Scratch</option>
                        <option value="3×Painted">3×Painted</option>
                    </select>
                </td>
                <td class="remarks-cell">
                    <input type="number" class="number-input" value="0" />
                    <input type="number" class="number-input" value="0" />
                    <button class="calc-btn" onclick="calculate(this, 'remarks')">Add</button>
                    <button class="calc-btn reset-btn" onclick="reset(this)">Reset</button>
                </td>
            </tr>
        </tbody>
    </table>
    <button class="add-row-btn" onclick="addRow()">Add Row</button>
    <button class="compile-btn" onclick="generatePDF()">Compile PDF</button>

    <!-- Link to External JavaScript -->
    <script src="script.js"></script>
</body>
</html><script>// Save data to local storage
function saveToLocalStorage() {
    const tableData = [];
    const rows = document.querySelectorAll("tbody tr");
    rows.forEach((row) => {
        const cells = row.querySelectorAll("td");
        tableData.push({
            part: cells[0].querySelector("select").value,
            color: cells[1].querySelector("select").value,
            total: cells[2].textContent,
            rework: cells[3].querySelector("input").value,
            polished: cells[4].querySelector("input").value,
            scrap: cells[5].querySelector("input").value,
            remarks: cells[6].querySelector("input").value,
            reworkDefect: cells[3].querySelector("select").value,
            scrapDefect: cells[5].querySelector("select").value,
        });
    });
    localStorage.setItem("loadingSheetData", JSON.stringify(tableData));
}

// Load data from local storage
function loadFromLocalStorage() {
    const tableData = JSON.parse(localStorage.getItem("loadingSheetData"));
    if (tableData) {
        const table = document.getElementById("loadingSheet").getElementsByTagName("tbody")[0];
        table.innerHTML = ""; // Clear existing rows
        tableData.forEach((data) => {
            const newRow = table.insertRow();
            newRow.innerHTML = document.querySelector("tbody tr").innerHTML;
            const cells = newRow.querySelectorAll("td");
            cells[0].querySelector("select").value = data.part;
            cells[1].querySelector("select").value = data.color;
            cells[2].textContent = data.total;
            cells[3].querySelector("input").value = data.rework;
            cells[4].querySelector("input").value = data.polished;
            cells[5].querySelector("input").value = data.scrap;
            cells[6].querySelector("input").value = data.remarks;
            cells[3].querySelector("select").value = data.reworkDefect;
            cells[5].querySelector("select").value = data.scrapDefect;
        });
    }
}

// Attach save functionality to relevant events
document.addEventListener("input", saveToLocalStorage);
document.addEventListener("DOMContentLoaded", loadFromLocalStorage);</script>