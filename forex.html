<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forex Chart Simulator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        canvas { max-width: 800px; margin: 20px auto; display: block; }
        button, select, input { margin: 10px; padding: 10px; }
    </style>
</head>
<body>
    <h2>Forex Chart Simulator</h2>
    <label for="instrument">Select Instrument:</label>
    <select id="instrument">
        <option value="Nasdaqe1.00">Nasdaqe1.00</option>
        <option value="Spe5.00">Spe5.00</option>
        <option value="Gero3.0">Gero3.0</option>
        <option value="Satrixo1.0">Satrixo1.0</option>
    </select>
    <label for="lotSize">Lot Size:</label>
    <select id="lotSize">
        <option value="10">0.1</option>
        <option value="20">0.2</option>
        <option value="30">0.3</option>
        <option value="40">0.4</option>
    </select>

    <button onclick="fundAccount()">Fund Account</button>
    <button onclick="withdrawFunds()">Withdraw</button>
    <button onclick="showTrades()">Show Trades</button>

    <h3>Balance: $<span id="balance">0.00</span></h3>

    <canvas id="forexChart"></canvas>

    <script>
        let balance = 0;
        let trades = JSON.parse(localStorage.getItem('trades')) || [];
        let ctx = document.getElementById('forexChart').getContext('2d');
        let forexChart = new Chart(ctx, {
            type: 'line',
            data: { labels: [], datasets: [{ label: 'Price', data: [], borderColor: 'blue', borderWidth: 2 }] },
            options: { animation: { duration: 0 } }
        });
        
        let currentPrices = {};
        
        function getPattern(type, step) {
            let data = [], x = 1000;
            for (let i = 0; i < 100; i++) {
                if (type === 'M') x += (i % 2 === 0 ? step : -step);
                else if (type === 'W') x += (i % 2 === 0 ? -step : step);
                else if (type === 'HeadShoulders') x += (i % 3 === 0 ? -step : step);
                else x += (i % 3 === 0 ? step : -step);
                data.push(x);
            }
            return data;
        }
        
        function updateChart() {
            let instrument = document.getElementById('instrument').value;
            let lotSize = parseInt(document.getElementById('lotSize').value);
            let pattern = ['M', 'W', 'HeadShoulders', 'InverseHeadShoulders'][Math.floor(Math.random() * 4)];
            let startPrices = { 'Nasdaqe1.00': 1000, 'Spe5.00': 3000, 'Gero3.0': 500, 'Satrixo1.0': 400 };
            let endPrices = { 'Nasdaqe1.00': 10000, 'Spe5.00': 15000, 'Gero3.0': 8000, 'Satrixo1.0': 10000 };

            if (!currentPrices[instrument]) {
                currentPrices[instrument] = startPrices[instrument];
            }

            let priceChange = lotSize; // Change by lot size (10, 20, 30, or 40)
            let direction = Math.random() < 0.5 ? 1 : -1; // Randomly decide to increase or decrease
            currentPrices[instrument] = Math.min(endPrices[instrument], Math.max(startPrices[instrument], currentPrices[instrument] + (priceChange * direction)));
            
            forexChart.data.labels.push(forexChart.data.labels.length + 1);
            forexChart.data.datasets[0].data.push(currentPrices[instrument]);
            forexChart.update();
        }
        
        function fundAccount() {
            let amount = parseFloat(prompt("Enter amount to fund:"));
            if (!isNaN(amount) && amount > 0) {
                balance += amount;
                document.getElementById('balance').innerText = balance.toFixed(2);
            }
        }
        
        function withdrawFunds() {
            let amount = parseFloat(prompt("Enter amount to withdraw (1 or 100%):"));
            if (amount === 100) amount = balance;
            if (!isNaN(amount) && amount > 0 && amount <= balance) {
                balance -= amount;
                document.getElementById('balance').innerText = balance.toFixed(2);
                alert("$" + amount + " withdrawn to game.html");
            }
        }
        
        function showTrades() {
            alert("Current Trades:\n" + trades.map(t => `${t.instrument} - $${t.amount}`).join('\n'));
        }
        
        setInterval(updateChart, 1000); // Update every second
    </script>

</body>
</html>
